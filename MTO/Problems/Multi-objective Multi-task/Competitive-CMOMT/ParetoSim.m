%------------------------------- Reference --------------------------------
% @Article{Li2025CMO-MTO,
%   title    = {Evolutionary Competitive Multiobjective Multitasking: One-Pass Optimization of Heterogeneous Pareto Solutions},
%   author   = {Li, Yanchi and Wu, Xinyi and Gong, Wenyin and Xu, Meng and Wang, Yubo and Gu, Qiong},
%   journal  = {IEEE Transactions on Evolutionary Computation},
%   year     = {2024},
%   doi      = {10.1109/TEVC.2024.3524508},
% }
%--------------------------------------------------------------------------

%------------------------------- Copyright --------------------------------
% Copyright (c) Yanchi Li. You are free to use the MToP for research
% purposes. All publications which use this platform should acknowledge
% the use of "MToP" or "MTO-Platform" and cite as "Y. Li, W. Gong, F. Ming,
% T. Zhang, S. Li, and Q. Gu, MToP: A MATLAB Optimization Platform for
% Evolutionary Multitasking, 2023, arXiv:2312.08134"
%--------------------------------------------------------------------------

D = {[30, 50]
    [50, 50]
    [50, 50]
    [50, 50]
    [30, 50]
    [50, 70]
    [50, 50, 50]
    [40, 50, 60]
    [30, 50]
    [50, 50]
    [30, 40, 40]
    [30, 30, 50]};

N = 100000;
XAll = rand(N, max([D{:}]));

for i = 1:12
    switch i
        case 1
            bias1 = [-9.13527797841981	-16.2082648491711	-14.4486752087909	-16.0192623944508	-8.67427656470271	-19.2137487750900	-4.25343232015194	-7.86861320139309	-4.04583861054979	-10.5714800811767	-6.31990250247348	15.2284002428808	-6.31718807778626	-3.39615038131274	-7.92875074585288	17.9635215435347	-13.8902436910941	17.0875551589738	-2.38013359052403	-12.6608275815406	-4.07052486727255	19.6121924418867	-12.0473606089581	19.6010716519629	-16.1889175966137	10.3605582912000	-8.09707280758548	-13.5873230168479	-19.6163666105176	2.40487074021731	-18.2573365255238	7.22260516713621	-14.0421570635625	-5.26446066290959	6.25886570715824	9.47784992624725	-8.28389006198788	10.9069629166264	3.00814937951452	1.46937887140187	-0.435111927087689	15.4422400315495	-11.3847360226638	9.91299269269211	-7.32793578821121	7.01851313685361	-1.61709294870711	19.9818360506391	-16.2564375659451];
            bias2 = [-3.81649392883520	-11.1304384535452	16.2246182745193	10.3334484227370	-18.3366726984208	-11.8621485907898	-9.73984802580137	-15.8269040815190	1.10294873843985	10.1087244129079	-13.7097663028583	13.9579412919757	-8.97001666459524	-1.72394441226304	-17.0576413945545	9.02638672376934	-19.3879827724572	-1.29635130096433	-13.5355610267249	9.93292316112996	14.8745446786945	3.62387187000754	4.60722485319673	-0.739886977924641	12.8269091662531	12.0568958103830	1.18168074848154	-1.92732379090882	-5.57496863032797	-11.4864353332927	4.60962089289755	-16.2328098492620	-8.06169279127171	-7.41309621728906	-9.77345795916754	3.35755514592094	9.61620976555011	1.26098376588603	9.04326519783723	-8.85155821189916	-13.7824305680979	3.09748268815469	-12.6300855277264	-8.47446760197438	0.607163174676643	15.8283577108118	8.38576220813439	-5.67418686992911	10.8836420504957];

            Lb{1} = -100 * ones(1, D{i}(1));
            Ub{1} = 100 * ones(1, D{i}(1));
            Lb{1}(1) = 0;
            Ub{1}(1) = 1;

            Lb{2} = -100 * ones(1, D{i}(2));
            Ub{2} = 100 * ones(1, D{i}(2));
            Lb{2}(1) = 0;
            Ub{2}(1) = 1;
        case 2
            bias1 = [-16.6939801248906	-19.6959095849610	11.9609150383881	-4.86409523042222	7.23711080175533	-11.1152371987641	-11.4095760183533	-11.0684371390115	-2.09950171719518	16.0326872417599	-18.4147089615011	-11.2898629956676	12.4919499016961	13.6075579873603	8.52422841623515	-19.8279835752731	-13.3754757982098	8.55301093375692	11.1241801465805	-17.4365484734890	-15.0871648899066	-6.67202034240537	5.28289097893259	16.7853491329511	-10.1014554179192	7.18450871779530	-5.08713138578391	13.8809749373964	-4.72497456358570	1.24349637404462	11.3836481848125	-8.54123580823073	11.2724206707310	-5.72590215241639	3.30767697833826	4.45983962988633	-19.8089073866343	-18.1198544164181	-14.2381970998006	1.45362276915507	1.00663014258665	10.1020874441183	3.31820487114308	7.62261430559168	2.70733509595447	-15.8468991015718	-19.7077507984316	19.4401018440334	0.790553346723918];
            bias2 = [0.360498436560944	0.291734265939657	0.0766769932424184	-0.217324641711788	0.356768117178448	-0.305820207637813	-0.158651557063833	-0.230731208689534	0.0314556206178322	0.295835422068319	-0.130277001729145	0.217228049594085	-0.321074364183932	-0.295871551548671	-0.191117634051849	-0.00928330715806397	-0.0193802763904066	-0.119391101577504	-0.374324922428515	0.324564246024338	0.146383735268404	0.230973342181140	0.369028737180490	-0.0771216692319784	0.297051209176359	0.0524829068902462	-0.0708264521255069	0.310020821790645	-0.159919236029533	0.0975498549398532	-0.0736843202145239	-0.0257699822286820	0.0674650953987025	0.0987213869194145	0.363983385885840	0.0920359362007364	-0.366816230448567	0.380617442888403	-0.371746957168618	0.180970950911618	-0.179425912362915	0.100881697759524	-0.270768135938233	0.354427109740524	-0.224186453870853	-0.349889556341703	-0.325849322234337	0.286001157998704	-0.303254568857297];

            Lb{1} = -100 * ones(1, D{i}(1));
            Ub{1} = 100 * ones(1, D{i}(1));
            Lb{1}(1) = 0;
            Ub{1}(1) = 1;

            Lb{2} = -2 * ones(1, D{i}(2));
            Ub{2} = 2 * ones(1, D{i}(2));
            Lb{2}(1) = 0;
            Ub{2}(1) = 1;
        case 3
            bias1 = [11.7954499593551	14.0590302786511	-5.44005946484174	-4.37226473475122	-9.32692860187057	1.11369630867576	-17.1352549160130	-13.8386243771537	-9.62061385142002	0.849956612030134	4.81127398657576	-18.6343932039206	5.35638758097249	8.43338186528488	-4.48486240817595	-19.5058376960818	2.78414162428751	19.1510254251904	0.0810833198540593	2.35645728815657	0.360585244537877	-11.2578508373572	4.03746908030901	-13.5737918988932	-3.80665364887437	-10.4205748926402	-3.87068554091725	-6.07967184510388	12.8086751092396	-14.1668428876759	15.1045125565366	-18.0734811937907	-3.63021161318731	-15.0234581665480	1.75539200676995	14.7942632923261	-2.96701780813820	-15.8486795966049	-9.43777159718574	5.42896974105411	13.9196178414525	8.00605516193389	-15.6060321797227	-0.839064217606097	1.77668904723486	14.3000350339494	0.496885805851285	9.47236227085685	9.64974063594612];
            bias2 = [-19.3902160055703	5.55165699497995	33.3551619764017	-34.9335572453362	-8.62149933643873	-25.6779422145550	-16.8786807642295	11.3555332238343	38.1320506269796	27.6584325452579	-33.0943634989469	12.7113980818872	-17.9546730078113	1.66827238326476	39.0946710762935	23.9919120487339	-39.1718362312829	-15.1801128590945	26.3188283556836	2.89941390099248	20.3503312084298	-24.8993869188657	-20.1408832607636	-6.66008521071896	-36.8947453338391	16.0281115967882	18.2895541010059	-10.1121545980969	6.77953815961040	-25.0000633035495	-23.7135223269790	17.6504813427558	27.7163092661686	-28.4150794337149	-26.2516035449252	-21.3908238228838	-6.84125747920572	-38.1235499000825	-35.7530768846490	0.670318614929073	-30.1239470417472	-18.0613711078235	15.0573784206268	-10.2753356428069	-33.4346273528286	37.3225101125820	20.0422893032499	-7.74247860514330	-29.7251028201107];

            Lb{1} = -100 * ones(1, D{i}(1));
            Ub{1} = 100 * ones(1, D{i}(1));
            Lb{1}(1) = 0;
            Ub{1}(1) = 1;

            Lb{2} = -200 * ones(1, D{i}(2));
            Ub{2} = 200 * ones(1, D{i}(2));
            Lb{2}(1) = 0;
            Ub{2}(1) = 1;
        case 4
            bias1 = [1.20591026735345	2.22811351034045	-2.51957091975063	5.25247661697375	2.97514081126948	-4.29706828623762	5.02429903381089	-0.682395032338416	-4.43242520507757	-2.30463752017052	-2.53889826360347	-1.39402477135357	5.36173811376747	5.88871604628009	1.19495774431521	-1.34065226289484	1.62151821693980	4.06902937064034	0.903800025052077	-3.37372947286011	0.778785475713828	-1.35929773049732	-4.53229045618020	4.01371543850415	-4.32385342479270	1.56524872979020	0.906439484976537	4.33092001512999	3.57040753020297	3.62772161982591	-4.80078158121405	4.78194331776087	-5.44992333088839	1.20001759625663	-2.44563392693567	-4.68785642066409	-1.70350203530780	-2.17740412513858	1.88110878364793	-3.15069664880844	-3.86585954498067	-0.221306762159900	-4.30929574132737	0.117958972512009	3.84848333993361	1.91422293487289	3.61611797866548	0.112332428226198	5.88107665812291];
            bias2 = [0.0541383818040200	0.727947747134769	0.944013969674770	-0.425956018144349	0.701830398449494	-0.436191447101076	0.694377570342444	-0.713995502110268	-0.0199531005346278	0.223915554993241	-0.917870480943646	-0.106506149294080	0.435084466296787	0.968717356243626	0.119754530629489	0.0173598570274578	-0.337929270094089	0.196923519295406	0.680242799596885	-0.152823609830906	0.612127400179425	0.936344958197197	-0.963987506019189	-0.290092137244701	-0.649158577620371	0.787984983884187	-0.581905636036438	0.290791888049742	-0.124547688138433	0.425020297771601	-0.637053487357530	-0.422432251070686	-0.836373147682749	0.0723934205591408	-0.942878322505225	0.368282523973618	0.00849587585544231	-0.836179391110366	0.895023768919525	0.0234494052492431	-0.200476869542777	-0.295095377847208	0.871752295730186	-0.183377091422025	0.638825725406461	0.963460730133264	-0.717438826063765	-0.821813891931241	0.662071319087714];

            Lb{1} = -30 * ones(1, D{i}(1));
            Ub{1} = 30 * ones(1, D{i}(1));
            Lb{1}(1) = 0;
            Ub{1}(1) = 1;

            Lb{2} = -5 * ones(1, D{i}(2));
            Ub{2} = 5 * ones(1, D{i}(2));
            Lb{2}(1) = 0;
            Ub{2}(1) = 1;
        case 5
            bias1 = [0.595941581771791	-0.184404824878218	0.823133935760695	-0.608154527527011	0.631762334030168	-0.339360993123093	-0.272609933784681	-0.767488553926916	-0.195870274241917	0.157395937820091	-0.591257369090158	-0.989325459719546	0.266353651146236	-0.0916313281872194	0.0959714032312879	-0.267039356820413	0.536140935003358	-0.220129299054798	0.178280481514484	0.163811789693301	0.890645984871892	0.184699021466365	-0.380069606303152	0.469767392425363	-0.572127988468877	0.491549834908472	-0.142379917278734	-0.415446477333489	0.951768372003815	0.784231577755914	-0.291554871454951	0.188051705878568	0.931941916826271	0.963744048909024	-0.0856764909054757	0.166396531252098	-0.796378074754236	0.926564468157378	-0.0408673988432289	-0.628227321900779	-0.155161743471575	-0.289785216100572	-0.857805519899482	0.561602398524392	0.852540976920602	0.682234341158797	-0.0165126957401500	0.145114968138898	0.413674798853499];
            bias2 = [-0.414228142372990	0.528387938067264	0.432837175426769	-0.241486197193643	-0.573894261990763	0.515875661670030	0.389268777171952	-0.798369278234606	0.271371101981786	-0.0749188744704812	-0.941626353956696	0.320389657433720	-0.425173721968851	0.301673299409178	-0.534225313089252	0.758717681191557	0.152871393953612	-0.177054052530933	-0.861417404336705	0.476882570461378	-0.840048202638957	-0.859281915594123	-0.963325512124355	0.246430510064326	-0.990444316821684	-0.807936755925895	0.343977415917196	-0.499006785037297	0.164187916271050	-0.959723534888065	-0.760846443134614	0.649038575627370	0.713807200570518	0.874489252913814	0.493017198667847	-0.429643556498962	0.0311702863810526	0.441078155435154	-0.606833530823323	-0.408246432701881	0.494600352327644	0.179523150862337	0.839326965736036	0.345819736510414	-0.716763185857009	0.313243472910052	0.304364575322920	-0.536310016498758	-0.172409004316719];

            Lb{1} = -5 * ones(1, D{i}(1));
            Ub{1} = 5 * ones(1, D{i}(1));
            Lb{1}(1) = 0;
            Ub{1}(1) = 1;

            Prob.Fnc{2} = @(x)getFun_CMOMT(x, 5, 2, bias2 - 2);
            Lb{2} = -5 * ones(1, D{i}(2));
            Ub{2} = 5 * ones(1, D{i}(2));
            Lb{2}(1) = 0;
            Ub{2}(1) = 1;
        case 6
            bias1 = [46.8659404149841	37.4892137943808	-21.9790246550692	-41.3479913910883	-10.3755015538024	-50.5200573293820	33.4234540928332	-35.7698657968457	-24.1616572556218	-12.0979026472542	-12.0287603551088	-16.0762020021332	14.3954827126258	-28.7658473941403	-47.7346829169953	-16.8955064200641	-14.5274405687931	-44.0297436023842	-22.2042633518793	-2.78281864585359	-50.9304681843202	-10.7505382396916	-9.74909153658209	50.2039280870154	-13.5577563804818	2.51634757397648	-13.0024984653958	30.5597900704067	-29.3457563912449	-45.9443908093524	20.9739333711482	-13.1555505507007	-32.6733747985525	7.03414976695724	-3.17150006486732	-11.9724878256673	11.1471005733503	41.3817230122026	-40.6506788355001	-7.03865781755561	-55.1640381698878	40.2612578569297	-10.2561780485732	-17.0810288528684	0.887514454758559	56.3374648140716	56.3976842096697	39.0599602040521	-54.2720650600443];
            bias2 = [-1.61495322784244	-3.24819867053981	-0.855027703838958	3.82070094097161	0.320903394771928	1.21626707280618	-1.16067221113745	-0.557962126076933	-0.195729542089907	-2.80507696255019	3.61207274504408	-3.39646309085130	-0.316973568121358	1.79971752726404	2.39502420684696	2.75128269533508	-2.58859786400769	-3.63201610571637	0.127614855154278	-1.99635814059352	0.734756551128532	-1.69017345496343	3.88598424305647	0.917548530425149	2.31186714478168	-1.70326053865911	3.22981618919188	-0.593159281665749	1.37758764837268	-0.117421926157300	2.75840690382794	1.50419064708142	2.40173835417880	-0.948506584449846	1.22600967870780	3.35130900506227	1.48381866829266	3.32003791394795	2.70437152373185	1.07996829164743	-0.794851554947660	-1.56997629712309	-3.36071950685700	3.88201485669401	0.703890735485921	3.24307007565206	-2.87593552524656	-3.34509265357819	-1.66183480379775	1.36881562298156	-2.78112309926427	0.926938368970363	1.86872794753342	2.94918654718516	-1.97384624532739	2.22937147078648	3.11956212535107	0.832434895416348	-2.91023261755322	-3.55049499174623	-2.26097690162745	-3.84645063744248	-2.33108929046995	-2.45248313844197	1.53611033599592	0.533547847954701	1.25566793033866	-1.95428861183276	0.324345822850486];

            Lb{1} = -300 * ones(1, D{i}(1));
            Ub{1} = 300 * ones(1, D{i}(1));
            Lb{1}(1) = 0;
            Ub{1}(1) = 1;

            Lb{2} = -20 * ones(1, D{i}(2));
            Ub{2} = 20 * ones(1, D{i}(2));
            Lb{2}(1) = 0;
            Ub{2}(1) = 1;
        case 7
            bias1 = [-0.0387268930760234	0.286380587826410	0.350331756615238	0.153234635328968	-0.338084162295302	-0.0439679994323473	0.129948689687179	0.120454439454638	0.118717860389793	0.123068055241397	-0.368513433438268	0.00195220616214342	-0.130038427698272	-0.279606935236868	0.279247946890845	-0.198341786605893	-0.342977649658575	-0.0259598338114782	-0.00206033092277780	-0.298619067998522	0.157422823245543	0.339283909355874	-0.191263854279262	-0.166832630477606	-0.307084856066459	-0.359963629960585	0.240899634035811	0.342627589236315	-0.0825522053107577	-0.216585910295435	0.155235128309133	0.103610196810591	-0.0234655606929018	-0.211550104890266	0.0258427537791740	0.279828737296603	0.279730401425972	-0.366303680592745	-0.294374692151782	0.231129824574826	-0.152877618117238	-0.298904200600036	0.376557137091237	-0.135296187198778	-0.126117127470173	-0.0226012724697281	0.0793765113906906	0.238850406334374	0.123879765194989];
            bias2 = [0.00786737757761635	-0.380603022920593	-0.505853487562444	-0.0491809932551903	0.124749203028921	0.577528262767662	-0.428923201170429	-0.397128652042165	-0.521063983568789	0.270895199858523	-0.347976811428152	-0.565466684697285	-0.339596561834170	-0.285496554166576	-0.195247770631500	0.473292410813428	-0.353145809687645	0.292420706571193	0.494789220902106	-0.595714845644804	0.206222416965091	0.136499475227910	0.0296762489743903	0.411768273227753	0.465765549723343	-0.140671590344253	0.194465867131603	-0.0200076148040825	0.465637449630375	-0.266366048602951	0.157799417887120	0.495719112671183	0.351343004067449	0.299863607327058	-0.225867587566519	0.373902208755156	-0.248656547120044	-0.202632061676302	0.257735180759856	-0.171141701769426	-0.594635267193758	0.323370951948630	-0.0283449326975401	0.519695554084053	-0.551179371281387	0.531928403599989	0.340979255634562	-0.0868750045949756	0.271905143133104];
            bias3 = [-0.153547618998937	0.00942694305199654	-0.377403907908034	-0.379624850784399	0.130110172460998	-0.0262975883739237	0.118160086346048	0.128440839428157	0.235056768163944	0.143939932314235	0.238517018862755	0.368540374595311	0.370708524673628	0.0938317820446685	0.274911384274414	0.0121479701913113	0.00722257335356880	0.0261945028628941	0.198915374640210	0.327643343062575	-0.325946501399995	-0.179252737909147	-0.310862574206943	0.213503233423870	0.0844229486970781	0.149458131855582	-0.135769288580462	-0.398699452064332	0.164559138301330	-0.127590362517355	-0.153246161785620	-0.0280196750130847	0.292582897573814	0.0845813505404699	0.305081721092795	0.120389350098976	0.256305945391557	-0.368763299608566	0.364771560882171	-0.0625483174561125	-0.309677810321507	0.382641743706970	-0.0832919597711560	0.232224467445982	-0.0114030015391940	0.0745133915342168	0.349983749395552	-0.219506737388337	-0.0744143701097556];

            Lb{1} = -2 * ones(1, D{i}(1));
            Ub{1} = 2 * ones(1, D{i}(1));
            Lb{1}(1) = 0;
            Ub{1}(1) = 1;

            Lb{2} = -3 * ones(1, D{i}(2));
            Ub{2} = 3 * ones(1, D{i}(2));
            Lb{2}(1) = 0;
            Ub{2}(1) = 1;

            Lb{3} = -2 * ones(1, D{i}(3));
            Ub{3} = 2 * ones(1, D{i}(3));
            Lb{3}(1) = 0;
            Ub{3}(1) = 1;
        case 8
            bias1 = [1.97822289216408	0.322901793141211	0.371213769123545	1.27588759587768	-0.489422961804486	-0.473996048632297	-0.386477369546927	1.95371485846275	-1.84173771170597	-0.0977968903087101	1.76727982417629	1.57316920109993	1.86165062465528	-0.977504385403921	0.737369422347768	-0.763608628272889	-0.195895891321804	0.360946039812112	1.89215836785142	-1.40130786681376	-1.43792499150266	0.481000410553829	-1.42990613467185	-0.964246668800511	-1.43394108425351	0.256536255603544	1.67208456568438	-1.11073834508723	-0.454867810377930	-1.69962720483462	-0.853151859243665	-1.16107325386791	-1.53277948697185	-0.649528373504912	1.68125602090789	1.43742186835129	-0.736862495456032	1.72452266119177	1.84043598106388];
            bias2 = [7.76449937997885	9.05856791759463	7.60169776235090	1.75320175485890	-3.83277992415170	-3.79512613590954	-3.39645867386478	-7.76360654959064	4.67125825068284	6.22934702090219	-7.10044082072745	-2.42235756316565	-4.53083309799719	8.38397350425598	7.11289941544414	9.71462411632679	6.76486582716300	6.65529897212775	1.10135752759242	-3.68112708863406	-1.36710429409343	-3.66048555483978	-1.52467623451258	-1.25944831312386	-8.59041750486024	-8.35806790071494	-7.56324925056869	-3.40576716269401	8.01565283762066	-4.10994721543886	-9.23801018791381	5.96108892967970	2.50231240271366	-9.73593610374759	-8.97437102328821	1.26143652138284	4.19636191701497	8.85654350853553	-7.18062676382082	5.35905674119817	-5.90998039660729	5.43872096437427	-4.39162008151334	-4.11706326751322	-4.03664214687629	-3.51460173724757	3.39005433130944	-5.84706789017915	-3.53803852017765];
            bias3 = [-0.192300200113088	0.447219247928535	0.701277334886625	-0.508106854736476	0.512520907220857	-0.913522061921286	0.182407867663269	0.941000461804038	0.703781169636184	0.169491367375241	0.912461151157353	0.634951775254376	-0.572209909644377	-0.899093776357607	0.755861953628096	-0.626121720661888	0.399840466771069	-0.826992595639063	-0.979523373645337	-0.216414710003796	0.354279144377184	0.808726371653836	-0.262007349260541	0.398158667371934	-0.248058092131445	0.563126676288249	-0.871711930038447	0.534726778634441	0.390175460885208	-0.566289157844147	-0.609270908441034	0.990419093820902	0.248083832402875	0.881980986494864	-0.834736890850738	0.892202580779946	0.448205108330025	-0.151752492416047	-0.317099227661223	-0.563899588418863	-0.668629990823982	0.369443262294022	-0.582164660368771	-0.351341946756860	0.478692231943485	0.179351223872654	-0.340549013163777	0.900641248073717	0.576695464304788	-0.686845506939773	-0.258437295050659	0.213951051388926	-0.698463220800517	-0.989514723305837	-0.583419917724622	0.666243645191758	-0.174590626720509	0.113173925805912	-0.460509001343270];

            Lb{1} = -10 * ones(1, D{i}(1));
            Ub{1} = 10 * ones(1, D{i}(1));
            Lb{1}(1) = 0;
            Ub{1}(1) = 1;

            Lb{2} = -50 * ones(1, D{i}(2));
            Ub{2} = 50 * ones(1, D{i}(2));
            Lb{2}(1) = 0;
            Ub{2}(1) = 1;

            Lb{3} = -5 * ones(1, D{i}(3));
            Ub{3} = 5 * ones(1, D{i}(3));
            Lb{3}(1) = 0;
            Ub{3}(1) = 1;
        case 9
            bias1 = [50.0527081308063	-6.57920050830526	54.9814033043600	-47.2552345038836	22.9144120264765	57.3234134981069	-36.1705866714070	-38.5552364759172	54.7756255327712	43.0071246269938	45.0788655295723	-24.8608694931216	-21.1190311568028	-22.4128588387199	2.23593775183717	12.1771845559462	-28.6712202760239	54.2899971361090	36.8011649034440	-12.9450892315800	3.26335963452238	23.8334236860546	-47.7613556388186	-23.9398718660504	51.3524995433714	42.7152711595889	-44.0559449440132	38.5828622041447	-28.5312087293982];
            bias2 = [-67.3313926725755	0.228166756060816	68.5418882249321	23.6570870065091	-86.0843969813580	56.8032422804046	-67.4359897231707	-13.3200378218439	37.1723483873018	-26.7736400363212	-71.6601623307869	-18.5003098193769	15.6781470629237	-10.2945474217076	86.7168205735586	57.3001415380173	38.2791669170618	44.4189903805964	8.71971883028920	-38.8241457953936	68.3958161802013	-3.76724781807320	-62.5985833813300	79.7561046528006	-74.9645210101275	-55.5107904385218	11.0415509985334	-53.4792931830350	-15.4220926134087	-35.2928156191316	76.4073702665116	46.9790949781489	91.7675839713244	-35.8746810603050	-23.3807889290338	-69.8369172240043	12.3924020316047	37.0972717348606	-81.8713788486507	-13.6319213006847	-68.1029410708590	59.6888789351468	-44.9580067894186	-62.1092003679439	-7.81246678531696	65.6269997620154	-86.6171047821278	3.14139088237037	-54.2111668159825];

            Lb{1} = -300 * ones(1, D{i}(1));
            Ub{1} = 300 * ones(1, D{i}(1));
            Lb{1}(1:2) = 0;
            Ub{1}(1:2) = 1;

            Lb{2} = -500 * ones(1, D{i}(2));
            Ub{2} = 500 * ones(1, D{i}(2));
            Lb{2}(1:2) = 0;
            Ub{2}(1:2) = 1;
        case 10
            bias1 = [-4.82020684010322	4.74752632818201	3.48588254303886	2.90117458531370	-5.06231116552220	5.38238506120545	-4.43608117128700	5.03076172826972	1.60623696238515	-0.468738876941664	5.75436072543102	4.36537780310523	1.92177883372120	-2.80507613426274	3.54159132406532	-0.595667655227505	4.95026641733016	3.10204442320073	-5.97737249073636	4.35446612192685	-4.49951706237544	0.885272824889003	-2.07764089686507	-5.41998126465641	0.618415770037272	2.38755548103499	1.02039073824325	-5.81631618517043	-2.04081167680115	-2.74173639581946	-0.0287877697952252	-1.58764498015050	-5.50132194884007	5.97616488319559	3.82282902900181	1.76455962204004	-5.57061500178331	-2.08253546417490	3.10841500775258	-4.04870891182701	4.08619299161592	-4.91376134051915	-1.47140140428395	5.60301985565665	0.588827746444721	5.89506542416924	-4.04531660926287	3.94851766513001	-0.351622385587574];
            bias2 = [0.595307559328067	-0.389296617217674	-0.575474465768648	0.307448467106739	0.644342239416125	-0.741761568189376	-0.824123713069284	0.594887955848018	0.888556834106754	0.916918954682354	-0.955079823076212	0.779111826535496	0.169323770049573	-0.436600269575767	0.615664931171220	-0.384701903476643	0.566511642156481	0.308393102211928	0.968918004991438	0.978324371173153	0.169243240349090	0.825198667935977	-0.345499601489997	0.929124610766189	0.252842643823026	-0.656745309679736	-0.346088420535815	-0.186416746815303	-0.380469911200674	-0.784475111277222	0.865468409366361	0.631436278027446	-0.00424502489035517	-0.580395715496922	0.492069487185040	-0.396087999015833	0.279831549676043	0.325287315628398	0.0367841267191180	-0.661994921673851	0.242711834864330	-0.341777737820963	0.979464352026796	-0.0489964776966205	0.139537693459892	-0.393589361681606	-0.938021770438205	0.233787600498240	-0.772822555313165];

            Lb{1} = -30 * ones(1, D{i}(1));
            Ub{1} = 30 * ones(1, D{i}(1));
            Lb{1}(1:2) = 0;
            Ub{1}(1:2) = 1;

            Lb{2} = -5 * ones(1, D{i}(2));
            Ub{2} = 5 * ones(1, D{i}(2));
            Lb{2}(1:2) = 0;
            Ub{2}(1:2) = 1;
        case 11
            bias1 = [9.32376866626440	6.18269238119385	1.19663607430808	-7.52109993518321	-1.51539288895502	-2.60329292014269	-4.37200299514176	0.637959586456171	5.87210069552131	1.66488760084288	-7.04389212072103	-2.12801318413160	-0.938376583442704	-4.65361718151423	0.623162216988764	-2.60403523535667	-4.32055455772031	5.76844525859572	8.59132680349261	-3.46265918709961	2.62155480524459	4.56014590570218	-5.52252944495933	-5.19344618710262	9.10994670633668	4.09177212613815	-9.04500954850258	6.09557628430365	7.30505494806486];
            bias2 = [-3.44186850006612	-5.01917432229208	-5.56946033447344	3.92431284626220	-6.01571844058314	-5.22437347914487	-1.66839029323777	1.79348260877381	6.95842732876153	-2.11116393408759	-0.0621610168504958	-4.62758727441299	7.11622123340810	-8.09383516002733	9.18100671403229	-4.20414464663889	9.37849070189397	8.86377395770962	-0.0353427955415455	-4.34116921165796	3.08296845727327	-5.69385441093635	-2.63435667192231	-4.57336224068849	6.11416803281906	-9.71386188478370	8.91059566215747	4.16591518913952	-3.51271602416221	-7.67864498677504	-4.78224292584025	-3.94330913658835	3.74094752817965	0.770017768472274	-6.58473055200350	2.04100625990152	7.99425845299358	-1.44893166671843	-9.69607781334308];
            bias3 = [-1.25360926144492	14.0053000844463	-9.85796928762456	9.04771392473985	-17.3098651788877	-15.1950142973658	4.79155027797725	-7.26174908200605	4.23522554995068	-5.83722615484407	-5.61337283054339	15.4664962294922	2.35894455713389	11.8801575472169	2.40038039513635	6.40010185310386	5.60656522784287	-3.98269399288962	-0.920530022953404	13.2887276551285	14.7478890257430	10.1390769080318	-11.9667271250370	-6.89656507053504	-3.60270607352774	-15.3337319497581	-6.47923991821105	-12.7961729056673	-6.98891277426545	-0.314885344826628	14.1217186487677	-4.17486876292010	1.68780695385573	13.6966564559530	-1.54806890988411	9.16814886447498	16.0865048022359	11.3018295676818	11.2002184530119];

            Lb{1} = -50 * ones(1, D{i}(1));
            Ub{1} = 50 * ones(1, D{i}(1));
            Lb{1}(1:2) = 0;
            Ub{1}(1:2) = 1;

            Lb{2} = -50 * ones(1, D{i}(2));
            Ub{2} = 50 * ones(1, D{i}(2));
            Lb{2}(1:2) = 0;
            Ub{2}(1:2) = 1;

            Lb{3} = -100 * ones(1, D{i}(3));
            Ub{3} = 100 * ones(1, D{i}(3));
            Lb{3}(1:2) = 0;
            Ub{3}(1:2) = 1;
        case 12
            bias1 = [-5.71090757771439	2.84319089692180	1.96699859645816	1.48254214412029	0.757757265419606	-5.19765852280156	6.11370223232512	-2.22861477241795	2.11899359794437	0.705695933997086	6.74271047770518	-3.37913603526375	-9.27556479706460	6.10947475382214	9.79436613252412	2.01448892902953	0.261753811034835	-4.38644390181330	-5.48757807230179	1.31610571429933	-2.93141324454668	-0.730940390124244	-9.69656518930924	-2.71071035937184	-4.59343389594958	-5.79802841581647	-2.24028324068533	-5.91935200708983	-2.26124180379394];
            bias2 = [-38.7861967244610	47.8241101221807	82.4234042367826	-69.5997000996767	-17.5468059820102	-72.1861119741373	-6.69783889849091	-11.2785183882265	88.4589498353195	73.4228660525394	81.8890597753045	-78.2924365248657	-77.7084322820314	51.7882326036249	18.0125298815007	-21.0766842894581	-44.2420684317986	-84.0932054519000	76.6715642483315	74.6947189443208	36.9717099777469	72.8149307028968	17.8288967261851	4.74169722266151	-69.2900202451916	-15.4604825855525	60.9844040454717	15.3128073836597	-67.0724626023665];
            bias3 = [75.9484717320909	-29.2171810730873	5.39200370387654	-67.0435004827768	-49.5123700134747	-15.1195085088963	-36.3812935059237	-67.6721777544555	-91.9883166943805	-28.3569910966463	-93.2752380183324	-99.9906749717497	-73.1516633751887	-86.4764332629918	10.3099619810086	-96.1516889713587	-80.0231201379821	96.0008356620594	45.2831410258478	42.7109907500472	58.8950045677445	-54.0024667469700	-82.5986724208217	-24.5157275510070	-36.7146317696194	-95.9309658873721	60.8401121952342	-91.4462672007770	72.9317667929817	9.34628761070782	-25.5747356731657	-29.1982401542160	-6.14778425949412	68.1588017498116	-10.5632347648771	93.2047361158748	55.1794797141093	-58.1856992574808	38.2941713785685	85.1413859235087	-60.9867658404393	95.1320260737539	-65.4520922017227	17.3495724013024	14.9968522345908	97.1121253569952	-90.9629212183337	-52.7054482053366	-38.7773901463760];

            Lb{1} = -50 * ones(1, D{i}(1));
            Ub{1} = 50 * ones(1, D{i}(1));
            Lb{1}(1:2) = 0;
            Ub{1}(1:2) = 1;

            Lb{2} = -500 * ones(1, D{i}(2));
            Ub{2} = 500 * ones(1, D{i}(2));
            Lb{2}(1:2) = 0;
            Ub{2}(1:2) = 1;

            Lb{3} = -500 * ones(1, D{i}(3));
            Ub{3} = 500 * ones(1, D{i}(3));
            Lb{3}(1:2) = 0;
            Ub{3}(1:2) = 1;
    end

    X = XAll(:, 1:max(D{i}));
    if i == 7 || i == 8 || i == 11 || i == 12
        X1 = X(:, 1:D{i}(1)) .* (Ub{1} - Lb{1}) + Lb{1};
        X2 = X(:, 1:D{i}(2)) .* (Ub{2} - Lb{2}) + Lb{2};
        X3 = X(:, 1:D{i}(3)) .* (Ub{3} - Lb{3}) + Lb{3};

        [Obj1, CV1] = getFun_CMOMT(X1, i, 1, bias1);
        [Obj2, CV2] = getFun_CMOMT(X2, i, 2, bias2);
        [Obj3, CV3] = getFun_CMOMT(X3, i, 3, bias3);

        Best1 = getBestIdx(Obj1, CV1);
        Best2 = getBestIdx(Obj2, CV2);
        Best3 = getBestIdx(Obj3, CV3);

        % Center the data
        X1 = normalize_to_unit_ball(X(Best1, :));
        X2 = normalize_to_unit_ball(X(Best2, :));
        X3 = normalize_to_unit_ball(X(Best3, :));

        % Compute similarity
        d_max = 2; % Max possible distance for unit ball
        similarity1 = 1 - (chamfer_distance(X1, X2) / d_max); % Linear similarity mapping
        similarity2 = 1 - (chamfer_distance(X1, X3) / d_max); % Linear similarity mapping
        similarity3 = 1 - (chamfer_distance(X2, X3) / d_max); % Linear similarity mapping

        similarity = (similarity1 + similarity2 + similarity3) / 3;

        disp('Problem ' + string(i) + ' Pareto Shape Similarity ' + string(similarity));
    else
        X1 = X(:, 1:D{i}(1)) .* (Ub{1} - Lb{1}) + Lb{1};
        X2 = X(:, 1:D{i}(2)) .* (Ub{2} - Lb{2}) + Lb{2};

        [Obj1, CV1] = getFun_CMOMT(X1, i, 1, bias1);
        [Obj2, CV2] = getFun_CMOMT(X2, i, 2, bias2);

        Best1 = getBestIdx(Obj1, CV1);
        Best2 = getBestIdx(Obj2, CV2);

        % Center the data
        X1 = normalize_to_unit_ball(X(Best1, :));
        X2 = normalize_to_unit_ball(X(Best2, :));

        % Compute similarity
        d_max = 2; % Max possible distance for unit ball
        similarity = 1 - (chamfer_distance(X1, X2) / d_max); % Linear similarity mapping

        disp('Problem ' + string(i) + ' Pareto Shape Similarity ' + string(similarity));
    end
end

function Best = getBestIdx(Obj, CV)
Feasible = find(all(CV <= 0, 2));
if isempty(Feasible)
    Best = [];
else
    Best = NDSort(Obj(Feasible, :), 1) == 1;
end
end

function X_norm = normalize_to_unit_ball(X)
% Translate to origin
X = X - mean(X, 1);
% Scale to unit ball
X_norm = X / max(vecnorm(X, 2, 2));
end

function chamfer_dist = chamfer_distance(X1, X2)
% Compute pairwise distances
dist1 = pdist2(X1, X2);
dist2 = pdist2(X2, X1);
% Chamfer distance
chamfer_dist = mean(min(dist1, [], 2)) + mean(min(dist2, [], 2));
end
